"use strict";(()=>{var x=function(e,t="&",r="="){let n=new Map;return e.length&&e.slice(1).split(t).forEach(c=>{let h=decodeURIComponent(c),y=h.indexOf(r);y>=0?n.set(h.slice(0,y),h.slice(y+r.length)):n.set(h,null)}),n};var s=function(e,t=document){return t?.querySelector(e)},a=function(e,t=document){return Array.from(t?.querySelectorAll(e))};var g,A=new Worker("./worker.js"),k=[],L=x(location.search),o,v=!1,p,d,D=function(e){for(let t in d)t==e?d[t].removeAttribute("hidden-slowly"):d[t].setAttribute("hidden-slowly","true");d[e]?p.removeAttribute("hidden-slowly"):p.setAttribute("hidden-slowly","true")},f=document,u=f.children[0],O=async function(e){e.preventDefault(),e.stopPropagation();let t=this.getAttribute("parchment");S(),await $(t),k.push(t)},P=function(){location.hash=`#${this.id||""}`},l=function(e){return e?.length||(e?.length==0?e="README":e=L.get("p")||"index"),e.toLowerCase().indexOf(".md")<0?e+".md":e},S=function(){let e=history.state||{};e[l()]={sX:u.scrollLeft,sY:u.scrollTop},history.replaceState(e,"")},T=function(e){a("table",e).forEach(t=>{t.setAttribute("role","grid")}),a("img",e).forEach(t=>{t.setAttribute("decoding","async"),t.setAttribute("loading","lazy")}),a("h1, h2, h3, h4, h5, h6",e).forEach(t=>{t.addEventListener("click",P)}),a("a",e).forEach(t=>{let r=t.getAttribute("href"),n=r.indexOf(":"),c=r.indexOf("/");n>-1&&n<6&&c<8?(t.setAttribute("target","_blank"),t.setAttribute("data-tooltip","This link will be opened in a new tab.")):r[0]=="#"||(t.setAttribute("parchment",r),t.href=`?p=${r}`),t.addEventListener("click",O)})},C=new DOMParser,b=new Map,i,w,j=function(e){return b.has(e)?!0:(A.postMessage({id:e}),!1)};var E=async function(e){for(;o.children.length>0;)i?(i.body.appendChild(o.children[0]),console.debug("Moving the current render result...")):(o.removeChild(o.children[0]),console.debug("Removing the current render result..."));i=e,m();let t=i.body.children.length,r=0;for(let n=0;n<t;n++)i.body.children[r].tagName=="H1"&&!r?r++:o.appendChild(i.body.children[r]);v=!0,location.hash&&(location.hash=location.hash),history.state&&history.state[l()]&&(u.scrollTop=history.state[l()].sY||0,u.scrollLeft=history.state[l()].sX||0),D("")},$=async function(e){v=!1,e=l(e),D("loading"),j(e)?E(b.get(e)):w=e};A.addEventListener("message",e=>{let t=e.data;if(t.ok){let r=C.parseFromString(t.data,"text/html");T(r),b.set(t.id,r),w==t.id&&E(r)}else w==t.id});self.parsedDoms=b;var m=async function(e){i?(self.currentDom=i,f.title=`${s("h1",i)?.innerText||"Untitled"} - ${g?.site?.name||"Parchment"}`):f.title=`${e||"Loading"} - ${g?.site?.name||"Parchment"}`};f.addEventListener("readystatechange",function(){switch(this.readyState){case"interactive":{o=s("main.container"),p=s(".overlay"),d={loading:s("#loading-overlay")},m(),$(l()),k.push(l());break}case"loaded":{m();break}}});fetch("./conf.json").then(e=>e.json()).then(e=>{g=e,m()});addEventListener("beforeunload",()=>{v&&S()});})();
