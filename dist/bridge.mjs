"use strict";let B=Object.create;let R=Object.defineProperty;let _=Object.getOwnPropertyDescriptor;let G=Object.getOwnPropertyNames;let X=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;let V=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports);let F=(e,i,n,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of G(i))!K.call(e,s)&&s!==n&&R(e,s,{get:()=>i[s],enumerable:!(o=_(i,s))||o.enumerable});return e};let z=(e,i,n)=>(n=e!=null?B(X(e)):{},F(i||!e||!e.__esModule?R(n,"default",{value:e,enumerable:!0}):n,e));let N=V((vt,P)=>{(function(){"use strict";let e={fatal:!0},i=[new TextDecoder("iso-8859-15",e),new TextDecoder("utf-8",e),new TextDecoder("sjis",e),new TextDecoder("euc-jp",e),new TextDecoder("ascii")],n={debug:!1,parse:function(o,s){if(o instanceof Uint8Array)return n.Uint8(o);if(typeof o=="string")return n.Base64(o);if(o instanceof HTMLElement&&o.type==="file")return n.addListener(o,s);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(o,s){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(o===void 0||!(o instanceof HTMLElement)||o.tagName!=="INPUT"||o.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;s=s||function(){},o.addEventListener("change",function(r){if(!r.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let h=new FileReader;h.readAsArrayBuffer(r.target.files[0]),h.onload=function(d){s(n.Uint8(new Uint8Array(d.target.result)))}})},Base64:function(o){let s=function(d){let E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(d=d.replace(/^.*?base64,/,""),d=String(d).replace(/[\t\n\f\r ]+/g,""),!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(d))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");d+="==".slice(2-(3&d.length));let b,u="",t,a,l=0;for(;l<d.length;)b=E.indexOf(d.charAt(l++))<<18|E.indexOf(d.charAt(l++))<<12|(t=E.indexOf(d.charAt(l++)))<<6|(a=E.indexOf(d.charAt(l++))),u+=t===64?String.fromCharCode(b>>16&255):a===64?String.fromCharCode(b>>16&255,b>>8&255):String.fromCharCode(b>>16&255,b>>8&255,255&b);return u}(o=String(o));let r=s.length;let h=new Uint8Array(new ArrayBuffer(r));for(let d=0;d<r;d++)h[d]=s.charCodeAt(d);return n.Uint8(h)},Uint8:function(h){let s={data:null,pointer:0,movePointer:function(t){return this.pointer+=t,this.pointer},readInt:function(t){if((t=Math.min(t,this.data.byteLength-this.pointer))<1)return-1;let a=0;if(1<t)for(let l=1;l<=t-1;l++)a+=this.data.getUint8(this.pointer)*Math.pow(256,t-l),this.pointer++;return a+=this.data.getUint8(this.pointer),this.pointer++,a},readStr:function(t){let a=new Uint8Array(t),l=!1,c;a.forEach((f,p)=>{a[p]=this.readInt(1)});for(let f=0;f<i.length;f++)if(!l)try{if(c=i[f].decode(a),f===0)for(let p=0;p<c.length;p++){let g=c.charCodeAt(p);if(g>191||g>127&&g<160)throw new RangeError(`Invalid code point: ${g}`)}l=!0,console.debug(`String byte sequence in ${i[f].encoding}`)}catch(p){console.debug(`SMF string ${p}`)}return c||"String byte sequence read failed."},backOne:function(){this.pointer--},readIntVLV:function(){let t=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)t=this.readInt(1);else{let l=[];for(;128<=this.data.getUint8(this.pointer);)l.push(this.readInt(1)-128);let a=this.readInt(1);for(let c=1;c<=l.length;c++)t+=l[l.length-c]*Math.pow(128,c);t+=a}return t}};if(s.data=new DataView(h.buffer,h.byteOffset,h.byteLength),s.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;s.readInt(4);let r={};r.formatType=s.readInt(2),r.tracks=s.readInt(2),r.track=[];let h=s.readInt(1),d=s.readInt(1);128<=h?(r.timeDivision=[],r.timeDivision[0]=h-128,r.timeDivision[1]=d):r.timeDivision=256*h+d;for(let t=1;t<=r.tracks;t++){r.track[t-1]={event:[]};let E,b=s.readInt(4);if(b===-1)break;if(b!==1297379947)return!1;s.readInt(4);let a=0,l=!1,c,f;for(;!l&&(a++,r.track[t-1].event[a-1]={},r.track[t-1].event[a-1].deltaTime=s.readIntVLV(),(c=s.readInt(1))!==-1);)if(128<=c?f=c:(c=f,s.movePointer(-1)),c===255){r.track[t-1].event[a-1].type=255,r.track[t-1].event[a-1].metaType=s.readInt(1);let u=s.readIntVLV();switch(r.track[t-1].event[a-1].metaType){case 47:case-1:l=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:r.track[t-1].event[a-1].data=s.readStr(u);break;case 33:case 89:case 81:r.track[t-1].event[a-1].data=s.readInt(u);break;case 84:r.track[t-1].event[a-1].data=[],r.track[t-1].event[a-1].data[0]=s.readInt(1),r.track[t-1].event[a-1].data[1]=s.readInt(1),r.track[t-1].event[a-1].data[2]=s.readInt(1),r.track[t-1].event[a-1].data[3]=s.readInt(1),r.track[t-1].event[a-1].data[4]=s.readInt(1);break;case 88:r.track[t-1].event[a-1].data=[],r.track[t-1].event[a-1].data[0]=s.readInt(1),r.track[t-1].event[a-1].data[1]=s.readInt(1),r.track[t-1].event[a-1].data[2]=s.readInt(1),r.track[t-1].event[a-1].data[3]=s.readInt(1);break;default:this.customInterpreter!==null&&(r.track[t-1].event[a-1].data=this.customInterpreter(r.track[t-1].event[a-1].metaType,s,u)),this.customInterpreter!==null&&r.track[t-1].event[a-1].data!==!1||(s.readInt(u),r.track[t-1].event[a-1].data=s.readInt(u),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch((c=c.toString(16).split(""))[1]||c.unshift("0"),r.track[t-1].event[a-1].type=parseInt(c[0],16),r.track[t-1].event[a-1].channel=parseInt(c[1],16),r.track[t-1].event[a-1].type){case 15:this.customInterpreter!==null&&(r.track[t-1].event[a-1].data=this.customInterpreter(r.track[t-1].event[a-1].type,s,!1)),this.customInterpreter!==null&&r.track[t-1].event[a-1].data!==!1||(E=s.readIntVLV(),r.track[t-1].event[a-1].data=s.readInt(E),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer"));break;case 10:case 11:case 14:case 8:case 9:r.track[t-1].event[a-1].data=[],r.track[t-1].event[a-1].data[0]=s.readInt(1),r.track[t-1].event[a-1].data[1]=s.readInt(1);break;case 12:case 13:r.track[t-1].event[a-1].data=s.readInt(1);break;case-1:l=!0;break;default:if(this.customInterpreter!==null&&(r.track[t-1].event[a-1].data=this.customInterpreter(r.track[t-1].event[a-1].metaType,s,!1)),this.customInterpreter===null||r.track[t-1].event[a-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return r},customInterpreter:null};if(typeof P<"u")P.exports=n;else{let o=typeof window=="object"&&window.self===window&&window||typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;o.MidiParser=n}})()});let A={g2:new Set("gm,GM,g2,G2".split(",")),xg:new Set};for(let e of"XG,MU,AN,AP,DR,DX,PC,PF,SG,VL".split(","))A.xg.add(e),A.xg.add(e.toLowerCase());let O=class{#e={};context;set(e,i){this.#e[e]=i}has(e){return!!this.#e[e]}async read(e,i){if(!this.has(e))throw new Error(`No decoder registered for "${e}"`);return await this.#e[e].call(this.context||this,i)}};let Y=function(e,i){let n=!0;return i.forEach((o,s)=>{n=n&&e[s]===o}),n},w=function(e){let i=0;return e.forEach(n=>{i*=256,i+=n}),i},m=new TextDecoder,x=new O;x.set("s7e",async function(e){let i=new Uint8Array(await e.slice(0,65536).arrayBuffer()),n="MSB	LSB	PRG	NME",o=[0,0,0,0],s=32,r=0,h=0,d=!0,E=[],b=0;for(;d;){let u=i.subarray(r);([()=>{m.decode(u.subarray(0,4))==="YSFC"?(r+=80,h=1):r++},()=>{if(Y(u.subarray(0,4),o))E.forEach((t,a,l)=>{let c=w(i.subarray(t.start+4,t.start+8));t.length=c}),h=2;else{let t=m.decode(u.subarray(0,4)),a=w(u.subarray(4,8));E.push({type:t,start:a}),r+=8}},()=>{let t=E[b],a=i.subarray(t.start,t.start+t.length),l=32;switch(t.type){case"ENVC":{let c=s;for(;c<a.length;){let f=a.subarray(c,c+l),p=m.decode(f.subarray(0,10)).trimEnd();p.slice(0,5)==="Init "&&(p=""),p&&(n+=`
063	${(f[17]+13).toString().padStart(3,"0")}	${f[19].toString().padStart(3,"0")}	${p}`),c+=l}break}case"EDVC":{let c=s;for(;c<a.length;){let f=a.subarray(c,c+l),p=m.decode(f.subarray(0,10)).trimEnd();p.slice(0,5)==="Init "&&(p=""),p&&(n+=`
063	024	${f[19].toString().padStart(3,"0")}	${p}`),c+=l}break}case"EPVC":{let c=32,f=s;for(;f<a.length;){let p=a.subarray(f,f+c),g=m.decode(p.subarray(0,10)).trimEnd();g==="----------"&&(g=""),g&&(n+=`
063	${(p[17]+1).toString().padStart(3,"0")}	${p[19].toString().padStart(3,"0")}	${g}`),f+=c}break}}b++,b>=E.length&&(h=3,d=!1)}][h]||(()=>{d=!1}))()}return n});x.set("pcg",async function(e){let i=new Uint8Array(await e.arrayBuffer()),n="MSB	LSB	PRG	NME",o=100,s=0,r=0,h=!0,d=[],E=0;for(;h;){let b=i.subarray(o);([()=>{h=m.decode(b.subarray(0,4))==="INI2",r=b[15],o+=16,s=1},()=>{let u=m.decode(b.subarray(0,4)),t=b[5],a=b[7],l=b[11],c=w(b.subarray(12,16)),f=w(b.subarray(16,20)),p=w(b.subarray(36,40)),g=m.decode(b.subarray(44,44+l));d.push({type:u,tipMsb:t,tipLsb:a,nameLen:l,length:c,start:f,entryLen:p,name:g}),o+=64,r--,r<1&&(s=2)},()=>{let u=d[E],t=i.subarray(u.start,u.start+u.length);switch(u.type){case"PRG1":break;case"PBK1":{let a=63,l=(u.tipMsb?6:0)+u.tipLsb;for(let c=0;c<128;c++){let f=c*u.entryLen,p=t.subarray(f,f+u.entryLen),g=m.decode(p.subarray(0,24)).trimEnd().replace("InitProg","");g.length&&l>5&&(n+=`
${a.toString().padStart(3,"0")}	${l.toString().padStart(3,"0")}	${c.toString().padStart(3,"0")}	${g}`)}break}case"CBK1":{let a=63,l=(u.tipMsb?3:0)+u.tipLsb+10;for(let c=0;c<128;c++){let f=c*u.entryLen,p=t.subarray(f,f+u.entryLen),g=m.decode(p.subarray(0,24)).trimEnd().replace("InitCombi","");g.length&&l>12&&(n+=`
${a.toString().padStart(3,"0")}	${l.toString().padStart(3,"0")}	${c.toString().padStart(3,"0")}	${g}`)}break}}E++,E>=d.length&&(s=3,h=!1)}][s]||(()=>{h=!1}))()}return n});let W=["off","hall","room","stage","plate","delay LCR","delay LR","echo","cross delay","early reflections","gate reverb","reverse gate"].concat(new Array(4),["white room","tunnel","canyon","basement","karaoke"],new Array(43),["pass through","chorus","celeste","flanger","symphonic","rotary speaker","tremelo","auto pan","phaser","distortion","overdrive","amplifier","3-band EQ","2-band EQ","auto wah"],new Array(1),["pitch change","harmonic","touch wah","compressor","noise gate","voice channel","2-way rotary speaker","ensemble detune","ambience"],new Array(4),["talking mod","Lo-Fi","dist + delay","comp + dist + delay","wah + dist + delay","V dist","dual rotor speaker"]);let q=",a,i,u,e,o,ka,ki,ku,ke,ko,ky,kw,sa,si,su,se,so,sh,ta,ti,tu,te,to,t,ch,t,s,na,ni,nu,ne,no,ny,nn,ha,hi,hu,he,ho,hy,fa,fi,fu,fe,fo,ma,mi,mu,me,mo,my,mm,ya,yu,ye,yo,ra,ri,ru,re,ro,ry,wa,wi,we,wo,ga,gi,gu,ge,go,gy,gw,za,zi,zu,ze,zo,ja,ji,ju,je,jo,jy,da,di,du,de,do,dy,ba,bi,bu,be,bo,by,va,vi,vu,ve,vo,pa,pi,pu,pe,po,py,nga,ngi,ngu,nge,ngo,ngy,ng,hha,hhi,hhu,hhe,hho,hhy,hhw,*,_,,,~,.".split(","),j={};`hi*,
ka,„Åã
ki,„Åç
ku,„Åè
ke,„Åë
ko,„Åì
ky,„Åç!
kw,„Åèl
tsu,„Å§
ts,„Å§l
sa,„Åï
si,„Åô„ÅÉ
su,„Åô
se,„Åõ
so,„Åù
shi,„Åó
sh,„Åó!
ta,„Åü
ti,„Å¶„ÅÉ
tu,„Å®„ÅÖ
te,„Å¶
to,„Å®
tchy,„Å°!
tchi,„Å°
na,„Å™
ni,„Å´
nu,„Å¨
ne,„Å≠
no,„ÅÆ
ny,„Å´!
nn,„Çì
ha,„ÅØ
hi,„Å≤
hu,„Åª„ÅÖ
he,„Å∏
ho,„Åª
hy,„Å≤!
fa,„Åµ„ÅÅ
fi,„Åµ„ÅÉ
fu,„Åµ
fe,„Åµ„Åá
fo,„Åµ„Åâ
ma,„Åæ
mi,„Åø
mu,„ÇÄ
me,„ÇÅ
mo,„ÇÇ
my,„Åø!
mm,„á∫
ra,„Çâ
ri,„Çä
ru,„Çã
re,„Çå
ro,„Çç
ry,„Çä!
wa,„Çè
wi,„Çê
we,„Çë
wo,„Çí
nga,„Åã„Çö
ngi,„Åç„Çö
ngu,„Åè„Çö
nge,„Åë„Çö
ngo,„Åì„Çö
ngy,„Åç„Çö!
ng,„É≥
ga,„Åå
gi,„Åé
gu,„Åê
ge,„Åí
go,„Åî
gy,„Åé!
gw,„Åêl
za,„Åñ
zi,„Åö„ÅÉ
zu,„Åö
ze,„Åú
zo,„Åû
ja,„Åò„ÇÉ
ji,„Åò
ju,„Åò„ÇÖ
je,„Åò„Åá
jo,„Åò„Çá
jy,„Åò!
da,„Å†
di,„Åß„ÅÉ
du,„Å©„ÅÖ
de,„Åß
do,„Å©
dy,„Åß!
ba,„Å∞
bi,„Å≥
bu,„Å∂
be,„Åπ
bo,„Åº
by,„Å≥!
va,„Çî„ÅÅ
vi,„Çî„ÅÉ
vu,„Çî
ve,„Çî„Åá
vo,„Çî„Åâ
pa,„Å±
pi,„Å¥
pu,„Å∑
pe,„Éö
po,„ÅΩ
py,„Å¥!
!ya,„ÇÉ
!yu,„ÇÖ
!ye,„Åá
!yo,„Çá
ya,„ÇÑ
yu,„ÇÜ
ye,õÄÅ
yo,„Çà
!a,„ÇÉ
!u,„ÇÖ
!e,„Åá
!o,„Çá
!a,„ÇÉ
!u,„ÇÖ
!e,„Åá
!o,„Çá
la,„ÅÅ
li,„ÅÉ
lu,„ÅÖ
le,„Åá
lo,„Åâ
a,„ÅÇ
i,„ÅÑ
u,„ÅÜ
e,„Åà
o,„Åä
*,„Å£
~,
^,
_,`.split(`
`).forEach(e=>{let i=e.split(",");j[i[0]]=i[1]});let k=new TextEncoder;let I=function(e,i,n){let o=[],s=n==!1?i.readIntVLV():n;e==0||e==127;for(let r=0;r<s;r++){let h=i.readInt(1);if(o.push(h),h!=247){if(h!=240){if(h>127)return console.debug(`Early termination: ${o}`),o.pop(),i.backOne(),i.backOne(),new Uint8Array(o)}}}return new Uint8Array(o)};let Se="‚ô≠ùÑ´,ùÑ´,‚ô≠,,‚ôØ,ùÑ™,ùÑ™‚ôØ".split(",");let C=[new Map,new Map];C[0].set("base64",k.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"));C[0].set("base64url",k.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"));C[0].set("hex",k.encode("0123456789abcdef"));C[0].set("ovm43",k.encode("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_"));C[0].set("radix64",k.encode("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/"));C[0].set("radix64url",k.encode("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_"));C[0].set("xx",k.encode("+-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"));C[0].set("xxurl",k.encode("_-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"));C[0].set("z64",k.encode("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+/"));C[0].set("z64url",k.encode("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"));for(let[e,i]of C[0]){let n=new Uint8Array(128).fill(255);for(let o=0;o<i.length;o++)n[i[o]]=o;switch(e){case"hex":{for(let o=10;o<16;o++)n[o+55]=o;break}default:n[9]=254,n[10]=254,n[12]=254,n[13]=254,n[32]=254,n[61]=254}C[1].set(e,n)}console.debug(C);let Q=(e="base64",i,n=!1)=>{};self.bufferTo=Q;let S={red:"#ff7986",orange:"#fca022",grYellow:"#c9e10a",green:"#c1ff0a",white:"#b7e5e3",blue:"#2280ff"},v={black:"#000000",blue:"#0516bb",purple:"#48009a",inactive:22,medium:59,active:170,range:148},Z=[[6,26],[7,35],[8,44],[9,53],[10,62],[11,71],[12,80],[13,89],[14,98],[15,107],[16,116],[17,125],[18,134],[19,143],[20,152],[21,161],[22,170]],$={},J="06,68,2a,16,aa,3b".split(",");for(let e in v)$[e]=[],J.forEach(i=>{$[e].push(`${v[e]}${i}`)});let D=[];for(let e of Z)D.push([`${v.black}${e[0].toString(16).padStart(2,"0")}`,`${v.black}${e[1].toString(16).padStart(2,"0")}`]),e.push(e[1]-e[0]);let Te=`${S.orange}64`,Me=`${S.green}64`,Pe=`${S.white}64`,Re=`${S.red}64`,Ae=$.black[0],Oe=$.black[2],Ie=$.black[1];let ee=["?","gm","gs","sc","xg","g2","mt32","doc","qy10","qy20","ns5r","x5d","05rw","k11","sg","sd","pa","krs","s90es","motif","cs6x","trin","an1x","cs1x"];let te=["melodic","drum","menu"];let ae=[36,37,48,49,52,53],M=[20,21,22,23,24,25,26,28,29,30,31,36,37,48,49,52,53,64,65];let U=[0,1,2,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,26,28,32,38,40,41,42,43,44,45,46,47,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,91,92,93,94,95,98,99,100,101,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157];let kt="reverb,chorus,delay,insert0,insert1,insert2,insert3,insert4".split(",");let re={};ee.forEach((e,i)=>{re[e]=i});let se=[];U.forEach((e,i)=>{se[e]=i});let ie={length:M.length};M.forEach((e,i)=>{ie[e]=i});let ne={};te.forEach((e,i)=>{ne[e]=i});let T=8,y={port:T,ch:T<<4,chShift:Math.ceil(Math.log2(T))+4,cc:U.length,nn:128,pl:512,tr:256,cmt:14,rpn:6,rpnt:4,nrpn:ae.length,ace:8,drm:8,dpn:M.length,dnc:128,ext:3,efx:8,cvn:12,redir:32,vxPrim:3,invalidCh:255};y.chcc=y.cc*y.ch;let wt=new TextDecoder("l9"),ce=new Uint16Array(y.ch),oe=new Uint16Array(y.ch),le=new Uint16Array(y.ch),de=new Uint16Array(y.ch),fe=new Uint16Array(y.ch),he=new Uint16Array(y.ch),L=new Array(y.drm);for(let e=0;e<y.ch;e++)ce[e]=e*y.cc,oe[e]=e*y.rpn,le[e]=e*y.nrpn,de[e]=e*y.ace,fe[e]=e*y.ext,he[e]=e*y.cvn;for(let e=0;e<y.drm;e++){L[e]=new Uint16Array(y.dpn);let i=e*y.dpn*y.dnc;for(let n=0;n<y.dpn;n++)L[e][n]=i+n*y.dnc}if(typeof self?.require<"u")throw new Error("Environments supporting CommonJS is not supported.");let H=z(N(),1);if(typeof self?.require<"u")throw new Error("Environments supporting CommonJS is not supported.");H.default.customInterpreter=I;let Ut=function(){return new BroadcastChannel("cc.ltgc.octavia:MainInput")},Nt=function(){return new BroadcastChannel("cc.ltgc.octavia:MainOutput")};export{Ut as getBridge,Nt as getBridgeOut};
